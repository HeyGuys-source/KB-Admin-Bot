<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord Bot Status</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Custom styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    
    <!-- Meta refresh for auto-update -->
    <meta http-equiv="refresh" content="30">
</head>
<body>
    <div class="container mt-4">
        <div class="row">
            <div class="col-12">
                <!-- Header -->
                <div class="text-center mb-4">
                    <h1 class="display-4">
                        <i class="fab fa-discord text-primary"></i>
                        Discord Bot Status
                    </h1>
                    <p class="lead text-muted">Advanced Discord Bot System Monitor</p>
                </div>

                {% if status.get('error') %}
                <!-- Error Display -->
                <div class="alert alert-danger" role="alert">
                    <h4 class="alert-heading">
                        <i class="fas fa-exclamation-triangle"></i>
                        Error {{ error_code or '' }}
                    </h4>
                    <p>{{ status.error }}</p>
                </div>
                {% else %}
                
                <!-- Status Cards Row -->
                <div class="row g-3 mb-4">
                    <!-- Online Status -->
                    <div class="col-md-3">
                        <div class="card h-100">
                            <div class="card-body text-center">
                                {% if status.online %}
                                <i class="fas fa-circle text-success fa-2x"></i>
                                <h5 class="card-title mt-2 text-success">Online</h5>
                                <p class="card-text">Bot is running</p>
                                {% else %}
                                <i class="fas fa-circle text-danger fa-2x"></i>
                                <h5 class="card-title mt-2 text-danger">Offline</h5>
                                <p class="card-text">Bot is not responding</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- Latency -->
                    <div class="col-md-3">
                        <div class="card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-tachometer-alt text-info fa-2x"></i>
                                <h5 class="card-title mt-2">Latency</h5>
                                <p class="card-text">
                                    <span class="h4">{{ status.bot_status.latency or 0 }}ms</span>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Guilds -->
                    <div class="col-md-3">
                        <div class="card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-server text-warning fa-2x"></i>
                                <h5 class="card-title mt-2">Servers</h5>
                                <p class="card-text">
                                    <span class="h4">{{ status.bot_status.guilds or 0 }}</span>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Users -->
                    <div class="col-md-3">
                        <div class="card h-100">
                            <div class="card-body text-center">
                                <i class="fas fa-users text-primary fa-2x"></i>
                                <h5 class="card-title mt-2">Users</h5>
                                <p class="card-text">
                                    <span class="h4">{{ "{:,}".format(status.bot_status.users or 0) }}</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Detailed Information -->
                <div class="row g-3">
                    <!-- Bot Information -->
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-robot"></i>
                                    Bot Information
                                </h5>
                            </div>
                            <div class="card-body">
                                <table class="table table-sm">
                                    <tbody>
                                        <tr>
                                            <td><strong>Status:</strong></td>
                                            <td>
                                                {% if status.online %}
                                                <span class="badge bg-success">Online</span>
                                                {% else %}
                                                <span class="badge bg-danger">Offline</span>
                                                {% endif %}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><strong>Uptime:</strong></td>
                                            <td>{{ (status.bot_status.uptime // 3600) | int }}h {{ ((status.bot_status.uptime % 3600) // 60) | int }}m {{ (status.bot_status.uptime % 60) | int }}s</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Last Ping:</strong></td>
                                            <td>
                                                {% if status.bot_status.last_ping %}
                                                {{ status.time_since_ping }}s ago
                                                {% else %}
                                                Never
                                                {% endif %}
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><strong>Server Time:</strong></td>
                                            <td>{{ status.server_time[:19] }} UTC</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Statistics -->
                    <div class="col-lg-6">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-chart-bar"></i>
                                    Statistics
                                </h5>
                            </div>
                            <div class="card-body">
                                {% if status.bot_status.stats %}
                                <table class="table table-sm">
                                    <tbody>
                                        <tr>
                                            <td><strong>Commands Executed:</strong></td>
                                            <td>{{ "{:,}".format(status.bot_status.stats.commands_executed or 0) }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Messages Seen:</strong></td>
                                            <td>{{ "{:,}".format(status.bot_status.stats.messages_seen or 0) }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Errors Handled:</strong></td>
                                            <td>{{ "{:,}".format(status.bot_status.stats.errors_handled or 0) }}</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Guilds Joined:</strong></td>
                                            <td>{{ "{:,}".format(status.bot_status.stats.guilds_joined or 0) }}</td>
                                        </tr>
                                    </tbody>
                                </table>
                                {% else %}
                                <p class="text-muted">No statistics available</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Performance Indicators -->
                <div class="row g-3 mt-3">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="fas fa-heartbeat"></i>
                                    Health Status
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row text-center">
                                    <div class="col-md-3">
                                        <div class="health-indicator">
                                            {% if status.online %}
                                            <i class="fas fa-check-circle text-success fa-2x"></i>
                                            <p class="mt-2">Connection</p>
                                            {% else %}
                                            <i class="fas fa-times-circle text-danger fa-2x"></i>
                                            <p class="mt-2">Connection</p>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="health-indicator">
                                            {% if status.bot_status.latency and status.bot_status.latency < 200 %}
                                            <i class="fas fa-check-circle text-success fa-2x"></i>
                                            {% elif status.bot_status.latency and status.bot_status.latency < 500 %}
                                            <i class="fas fa-exclamation-circle text-warning fa-2x"></i>
                                            {% else %}
                                            <i class="fas fa-times-circle text-danger fa-2x"></i>
                                            {% endif %}
                                            <p class="mt-2">Latency</p>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="health-indicator">
                                            {% if status.time_since_ping < 60 %}
                                            <i class="fas fa-check-circle text-success fa-2x"></i>
                                            {% elif status.time_since_ping < 300 %}
                                            <i class="fas fa-exclamation-circle text-warning fa-2x"></i>
                                            {% else %}
                                            <i class="fas fa-times-circle text-danger fa-2x"></i>
                                            {% endif %}
                                            <p class="mt-2">Keep-Alive</p>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="health-indicator">
                                            {% if status.bot_status.guilds > 0 %}
                                            <i class="fas fa-check-circle text-success fa-2x"></i>
                                            <p class="mt-2">Servers</p>
                                            {% else %}
                                            <i class="fas fa-times-circle text-warning fa-2x"></i>
                                            <p class="mt-2">Servers</p>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                {% endif %}

                <!-- Footer -->
                <div class="text-center mt-4 mb-4">
                    <p class="text-muted">
                        <i class="fas fa-sync-alt"></i>
                        Page auto-refreshes every 30 seconds
                    </p>
                    <p class="text-muted small">
                        Advanced Discord Bot System | Keep-Alive Server
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Auto-refresh script -->
    <script>
        // Add visual indicator for auto-refresh
        let refreshCounter = 30;
        const refreshInterval = setInterval(() => {
            refreshCounter--;
            if (refreshCounter <= 0) {
                location.reload();
            }
        }, 1000);

        // Add loading states
        document.addEventListener('DOMContentLoaded', function() {
            // Add fade-in animation
            document.body.style.opacity = '0';
            setTimeout(() => {
                document.body.style.transition = 'opacity 0.3s';
                document.body.style.opacity = '1';
            }, 100);
        });
    </script>
</body>
</html>
